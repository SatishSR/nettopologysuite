import junit.framework.TestCase;

import com.vividsolutions.jts.geom.Geometry;
import com.vividsolutions.jts.geom.GeometryFactory;
import com.vividsolutions.jts.geom.PrecisionModel;
import com.vividsolutions.jts.io.ParseException;
import com.vividsolutions.jts.io.WKTReader;

public class GoogleGroupTest extends TestCase {

	public void test_buffer0_doesnt_fix_geometries() {
		String wkt = "POLYGON((487143.12056915415 4419332.297027817,487148.4826128975 4419333.241,487151.35381619935 4419331.6704359865,487145.873 4419330.326,487143.12056915415 4419332.297027817),(487240.64452267956 4419362.611054949,487240.093271455 4419355.237630927,487240.47771515214 4419355.457643805,487241.94552018255 4419356.297652398,487242.63676261925 4419356.693242803,487240.64452267956 4419362.611054949),(487175.0756521084 4419364.959860701,487175.514 4419365.097,487175.8617072951 4419364.1606901605,487176.279 4419363.037,487177.09182983835 4419363.294358757,487180.268 4419364.3,487182.201 4419358.304,487189.416 4419355.979,487190.104 4419354.183,487192.074 4419354.709,487192.777 4419352.591,487194.799 4419353.305,487195.406 4419351.194,487199.626 4419352.569,487200.544 4419350.67,487204.165 4419351.89,487204.876 4419349.797,487206.885 4419350.371,487208.855 4419344.411,487211.013 4419345.043,487213.198 4419337.699,487213.36468920583 4419337.247749596,487205.238 4419334.864,487203.3936632555 4419335.653620839,487195.9874482669 4419338.824463534,487195.957 4419341.536221268,487195.4493840775 4419343.353497175,487195.085 4419344.658,487192.317 4419343.764,487188.25 4419343.986,487187.546558571 4419345.1252605785,487185.611 4419348.26,487183.293 4419350.626,487180.353 4419352.759,487177.159 4419353.95,487175.95143943216 4419354.21729031,487175.3101193474 4419354.359244798,487173.73 4419354.709,487170.15 4419354.429,487167.027 4419353.693,487163.84 4419352.327,487161.166 4419350.415,487159.5639734854 4419348.730000001,487158.405 4419347.511,487155.867 4419356.501,487159.799 4419357.949,487159.218 4419359.983,487163.269 4419361.291,487162.635 4419363.231,487172.594 4419366.279,487173.577 4419364.491,487174.69657750975 4419364.841265343,487175.0756521084 4419364.959860701),(487090.689 4419453.346,487093.221 4419453.426,487104.096 4419451.142,487112.485 4419449.120999999,487109.93799999997 4419444.844999999,487113.2089999999 4419441.893999999,487118.689 4419441.779999999,487120.1429999999 4419444.486,487118.547 4419447.416999999,487122.35 4419447.132999999,487124.3169999999 4419431.821999999,487128.289 4419429.159,487134.1209999999 4419430.511,487134.52799999993 4419425.936999999,487138.728 4419425.66,487146.397 4419420.229,487149.961 4419420.378999999,487149.13399999996 4419424.014999999,487155.29999999993 4419427.981999999,487154.191 4419433.241,487152.382 4419435.3719999995,487142.1109999999 4419434.286999999,487137.027 4419440.228,487135.032 4419440.968,487133.029 4419440.173,487129.60899999994 4419445.427999999,487139.251 4419443.576,487149.961 4419441.321,487159.627 4419439.173,487167.814 4419437.268,487176.754 4419435.019,487181.545 4419434.043,487192.034 4419432.048,487202.054 4419429.431,487216.038 4419426.432,487227.184 4419423.946999999,487225.20199999993 4419421.466,487229.51399999997 4419419.196,487231.294 4419423.124,487236.017 4419422.061,487242.17 4419420.477,487236.429 4419418.401999999,487235.667 4419414.301999999,487238.45199999993 4419411.365,487245.2459999999 4419411.522,487245.59699999995 4419408.173,487248.623 4419405.480999999,487253.58699999994 4419409.336999999,487254.05849364935 4419409.976328004,487253.41298833094 4419412.235596618,487249.98374132684 4419416.592757516,487248.2892898661 4419418.401999999,487242.17 4419420.477,487248.229 4419419.35,487251.042 4419418.623,487255.394 4419413.277,487258.946 4419409.267,487264.575 4419402.803,487269.266 4419397.003,487271.669 4419393.13,487272.67 4419388.676,487271.756 4419384.824,487268.282 4419381.132,487263.159 4419378.92,487255.442 4419378.024,487247.066 4419378.678,487241.9420360908 4419377.615097525,487238.478053108 4419373.445893751,487238.1110360908 4419369.630097525,487240.1595282578 4419364.013622161,487236.948 4419366.184999999,487231.929 4419363.116999999,487232.248 4419357.979,487240.0892311838 4419355.235318725,487238.544 4419354.351,487235.314 4419352.431,487232.129 4419350.271,487228.246 4419347.718,487224.804 4419345.386,487222.421 4419341.462,487221.58823457133 4419339.659909387,487219.7643316328 4419339.124915642,487219.348 4419341.637,487224.039 4419346.357999999,487222.927 4419354.040999999,487219.196 4419360.759,487213.583 4419363.649,487204.201 4419360.686999999,487195.419 4419369.007999999,487189.606 4419380.0879999995,487185.13399999996 4419393.3149999995,487176.20199999993 4419394.361,487167.46499999997 4419386.572999999,487157.89099999995 4419380.85,487156.2679999999 4419369.515999999,487151.571 4419365.407,487146.57499999995 4419367.395,487141.218 4419354.488,487146.4719860089 4419346.646,487142.19331776694 4419339.936531815,487140.37365706515 4419337.083084224,487139.4620796622 4419335.65362084,487139.30299999996 4419335.418,487138.777 4419331.527999999,487139.30469432415 4419331.6678643515,487139.30299999996 4419331.624955887,487140.7938153163 4419331.887409581,487140.652 4419331.837,487138.835 4419331.492,487135.447 4419330.403,487125.902 4419326.4,487124.249 4419323.995,487118.848 4419320.768,487110.985 4419316.503,487101.806 4419311.852,487095.617 4419310.26,487091.624 4419310.697,487083.801 4419314.506,487076.314 4419319.193,487072.487 4419323.131,487070.105 4419328.084,487068.908 4419334.019,487068.526 4419342.436,487068.956 4419348.73,487070.22 4419350.535,487080.047 4419357.288,487089.283 4419364.727,487095.165 4419370.622,487099.913 4419377.189,487103.385 4419383.969,487105.666 4419390.028,487106.822 4419395.725,487106.412 4419400.548,487104.009 4419406.577,487100.781 4419410.21,487094.047 4419412.879,487087.88357091264 4419413.864999999,487079.368 4419415.239,487067.54 4419417.309,487064.898 4419419.844,487064.626 4419423.569,487066.972 4419427.824,487072.199 4419433.709,487078.761 4419439.073,487086.99779043987 4419448.624936048,487090.472 4419445.771,487093.982 4419443.66,487098.752 4419441.745,487109.195 4419439.578,487109.878 4419444.187,487101.804 4419445.899,487101.59483467275 4419445.970602643,487096.429 4419447.739,487093.283 4419449.512,487090.83 4419451.989,487090.689 4419453.346),(487124.64365867176 4419390.962,487125.8259149815 4419391.775457458,487124.98469414574 4419392.696,487124.32535889605 4419391.957343044,487124.64365867176 4419390.962),(487107.6137447421 4419374.699731413,487108.8612673502 4419375.62,487107.26868529734 4419376.663915945,487106.684 4419375.62,487106.684 4419375.0447908575,487107.6137447421 4419374.699731413),(487105.3575868339 4419365.617099826,487105.3575868339 4419367.002251491,487103.87117691786 4419367.321,487103.6588326441 4419366.099788327,487104.7205540127 4419365.383126403,487105.3575868339 4419365.617099826),(487110.2680481636 4419370.689,487110.4073990933 4419372.071971025,487109.07361162396 4419372.2046861965,487108.2242345291 4419371.4349382045,487108.8612673502 4419370.689,487109.57792927406 4419370.689,487109.92298871884 4419370.689,487110.2680481636 4419370.689),(487104.42858063633 4419359.8356322525,487105.3575868339 4419360.56,487104.7205540127 4419361.746730716,487103.6588326441 4419361.614015545,487103.216 4419360.56,487104.42858063633 4419359.8356322525),(487118.194 4419390.102,487119.33615201013 4419391.287878595,487117.711 4419392.239,487117.0057429381 4419391.373137464,487117.0057429381 4419390.962,487118.194 4419390.102),(487114.3556754327 4419372.071971025,487114.3397385907 4419373.841217059,487112.6370139674 4419373.691096112,487112.5523651692 4419372.2046861965,487113.7186426116 4419372.2046861965,487114.3556754327 4419372.071971025),(487102.9687137545 4419374.699731413,487103.87117691786 4419376.126,487102.27859486494 4419376.663915945,487100.8718140515 4419375.563,487101.649 4419375.0447908575,487102.9687137545 4419374.699731413),(487121.1961215923 4419393.838598896,487122.39656646067 4419393.420262048,487122.837 4419393.65671331,487123.6515770048 4419394.275124303,487123.269617274 4419395.179,487121.8299303264 4419395.390002534,487121.25068726816 4419394.620706916,487121.1961215923 4419393.838598896),(487112.6370139674 4419380.623804862,487113.2740467885 4419382.322559051,487112.5042987963 4419383.649710762,487111.3894913593 4419383.516995591,487110.4073990933 4419382.597,487110.897 4419381.552811059,487111.4425774277 4419381.340466785,487112.02652418043 4419380.85,487112.6370139674 4419380.623804862),(487114.12 4419386.812,487116.468 4419385.691,487117.711 4419386.812,487116.468 4419388.387,487115.58335901 4419388.387,487114.12 4419386.812),(487117.23891252436 4419383.114287995,487118.999 4419380.85,487120.116 4419382.597,487120.116 4419384.04,487118.194 4419384.04,487117.711 4419384.04,487117.23891252436 4419383.114287995),(487163.35152467916 4419432.2105301125,487163.595 4419432.904,487164.19236438896 4419433.070905788,487165.406 4419433.41,487166.845 4419432.802,487166.906 4419430.77,487163.035 4419431.309,487163.35152467916 4419432.2105301125),(487158.978 4419436.193,487160.818 4419436.646,487162.056 4419435.738,487162.3353371833 4419434.031699095,487162.342 4419433.991,487162.2549905827 4419434.003131414,487158.053 4419434.589,487158.978 4419436.193),(487164.4592575609 4419402.517779068,487167.46499999997 4419401.193017091,487168.9933020763 4419399.812279254,487171.41892259894 4419400.390696456,487171.263 4419402.573754926,487171.7734363676 4419405.932306419,487171.0830674496 4419407.9101200765,487169.441108942 4419407.9101200765,487168.0230538672 4419405.633768509,487165.6907264416 4419404.887423732,487164.218 4419403.599978994,487164.4592575609 4419402.517779068),(487133.769053152 4419347.730531702,487137.65097190597 4419348.261392387,487140.748 4419350.451192709,487139.30299999996 4419352.209668726,487136.2242838169 4419353.238211301,487134.0344834942 4419354.830793355,487132.141 4419354.685533253,487132.418 4419350.841,487133.769053152 4419347.730531702),(487086.07999999996 4419329.768999999,487092.51 4419326.384,487094.59699999995 4419317.739,487086.8879999999 4419319.624,487086.07999999996 4419329.768999999),(487099.25457906607 4419326.699,487099.95133371424 4419323.866660701,487102.2406704152 4419321.776396756,487105.7576224487 4419321.9422907205,487108.27921069914 4419322.231,487109.7722563737 4419320.615139009,487112.9574204795 4419320.449245046,487112.8578841012 4419322.506,487110.66808377847 4419324.828845691,487109.1750381039 4419327.748579455,487106.78616502456 4419328.232,487104.96133142227 4419326.384,487102.2406704152 4419327.027028695,487100.0508700925 4419327.549506698,487099.25457906607 4419326.699),(487149.404 4419406.194,487155.5 4419401.255999999,487152.456 4419395.398,487145.172 4419390.753999999,487140.51099999994 4419393.604,487136.662 4419390.102,487130.502 4419392.696,487132.404 4419395.779999999,487131.2899999999 4419401.765999999,487141.38899999997 4419401.973999999,487149.404 4419406.194),(487122.196 4419398.057,487114.12 4419395.179,487107.511 4419399.542767949,487107.511 4419403.913,487104.41 4419406.265,487104.41 4419410.236,487108.83111372095 4419413.65,487116.468 4419414.943,487118.877 4419413.65,487118.194 4419408.836,487121.44191549026 4419406.603,487122.837 4419402.727,487122.196 4419398.057),(487094.68499999994 4419366.138,487099.65099999995 4419364.669,487100.199 4419360.935999999,487103.216 4419357.589,487110.44999999995 4419360.411,487111.914 4419357.725,487109.044 4419351.74,487112.23 4419349.147,487110.753 4419347.068,487104.19499999995 4419347.361,487103.348 4419350.364,487095.43499999994 4419352.355,487094.091 4419348.926999999,487090.56499999994 4419347.591,487087.223 4419349.163999999,487084.31999999995 4419355.784,487085.75899999996 4419357.764,487089.82699999993 4419358.507999999,487091.56499999994 4419363.631999999,487094.68499999994 4419366.138),(487231.294 4419367.294,487235.667 4419368.571,487237.81819702766 4419372.049,487238.45199999993 4419375.487941678,487236.948 4419379.286,487238.646 4419381.281,487242.348 4419382.887734613,487243.641 4419386.463418942,487240.721 4419390.686,487239.82 4419395.897,487235.667 4419398.129,487230.62206811795 4419395.897,487226.447 4419392.697,487223.123 4419390.828,487224.039 4419385.243,487224.039 4419380.0879999995,487221.4571869594 4419375.352165661,487222.927 4419370.059,487231.294 4419367.294),(487187.382 4419430.243999999,487191.6429999999 4419429.851,487192.561 4419425.966,487198.794 4419428.882999999,487213.44499999995 4419425.209999999,487225.93299999996 4419419.388,487225.22899999993 4419415.541999999,487220.32699999993 4419415.734999999,487214.519 4419411.373,487205.108 4419413.150999999,487197.08699999994 4419416.037999999,487195.252 4419413.631999999,487189.726 4419414.943,487187.598 4419421.733999999,487184.55499999993 4419427.772,487187.382 4419430.243999999))";
		
		GeometryFactory factory = new GeometryFactory(new PrecisionModel(
				PrecisionModel.FLOATING));
		WKTReader reader = new WKTReader(factory);
		Geometry geom = null;
		try {
			geom = reader.read(wkt);
		} catch (ParseException e) {
			e.printStackTrace();
			fail(e.getMessage());
		}
		assertNotNull(geom);
		assertFalse(geom.isValid());

		Geometry fixedGeom = geom.buffer(0);
		assertNotNull(fixedGeom);
		assertTrue(fixedGeom.isValid());
		System.out.println(fixedGeom);
	}
}